<!DOCTYPE html>
<html lang="en">
<head>
 <% print.forEach(function (pr) { %>
 <title>
  <%=pr.name%>
</title>
<% }); %>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<link rel="stylesheet" href="/stylesheets/style.css" >
<link href="https://fonts.googleapis.com/css?family=Raleway:200,100" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">

<link rel="stylesheet" href="/stylesheets/navbar.css">



<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="/javascripts/amount.js"></script> 
<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>

<style>
.stars-outer{
  position:relative;
  display: inline-block;
  top: 20px;
}

.stars-inner {
  position:absolute;
  top:0;
  left:0;
  white-space: nowrap;
  overflow: hidden;
  width:0;
}

.stars-outer::before {
  content: "\f005 \f005 \f005 \f005 \f005";
  font-family: 'Font Awesome 5 Free';
  font-weight: 900;
  color: #dcdcdc;
}

.stars-inner::before {
  content: "\f005 \f005 \f005 \f005 \f005";
  font-family: 'Font Awesome 5 Free';
  font-weight: 900;
  color: #337ab7;
}

.ratingClass {
  margin-top: 25px;
}
.title .date { float:right }

</style>


<body>

  <div id="navbarHere"><% include ../public/navbar/navbar %></div>



  <div class="container">
    <div class="row">
      <div  class="col-md-6">

        <div id="carousel-example-generic" class="carousel slide col-sm-12" style="height: 600px; margin:0 auto;" data-ride="carousel">
          <!-- Indicators -->
          <ol class="carousel-indicators">
            <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
            <li data-target="#carousel-example-generic" data-slide-to="1"></li>
            <li data-target="#carousel-example-generic" data-slide-to="2"></li>
          </ol>
          <% print.forEach(function (pr) { %>

          <!-- Wrapper for slides -->
          <div class="carousel-inner" role="listbox">
            <div class="item active">
              <img src="/images/<%=pr.model_no%>/000001.jpg" style="width:auto; height:350px;">

            </div>
            <div class="item">
              <img src="/images/<%=pr.model_no%>/000002.jpg" style="width:auto; height:350px">

            </div>
            <div class="item">
              <img src="/images/<%=pr.model_no%>/000003.jpg" style="width:auto; height:350px">

            </div>
          </div>
          <% }) %>

          <!-- Controls -->
          <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
            <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>
      </div>
      <div class="col-md-6 ">
        <div class="customDiv" id = "Kamil" style="width: 80%; padding-left: 10%;">
          <br>
          <br>
          <% print.forEach(function (pr) { %>
          <input type="text" name="pid" id='pid' style="display: none;" value='<%=pr.model_no%>'  />
          <input type="text" name="price" id='price' style="display: none;" value='<%=pr.price_usd%>'  />
          <input type="text" name="pid2" id='pid2' style="display: none;"  value='<%=pr.model_no%>'  />

          <p ><strong><%=pr.name%></strong></p>
          <h1 class="text-primary"><%=pr.price_usd%></h1>
          <h3 class="text-primary">Stock Count: <%=pr.quantity%></h1>

            <p></p>
            <% }) %>





            <div class="container">
              <div class="row">



                <div class="col-lg-1">
                  <div class="input-group">
                    <span class="input-group-btn">
                      <button type="button" class="quantity-left-minus btn btn-danger btn-number"  data-type="minus" data-field="" style="position:absolute; right:-25px; top:0px;" >
                        <span class="glyphicon glyphicon-minus"></span>
                      </button>
                    </span>
                    <input type="text" id="quantity" name="quantity" class="form-control input-number" value="1" min="1" max="100" style="text-align:right;  right:-25px" >
                    <span class="input-group-btn">
                      <button type="button" class="quantity-right-plus btn btn-success btn-number" data-type="plus" data-field="" style="position:absolute; left: 25px; top:0px; " >
                        <span class="glyphicon glyphicon-plus"></span>

                      </button>
                    </span>

                  </div>

                </div>

              </div>

            </div>
            <br><button type="button" id ="myAnchor" class="btn btn-primary btn-lg" >Add to cart</button><br>

            <%if(user){%>
            <input type = "number" class = "ratingClass"id = "ratingNumber" min = "1" max ="5">   </input>
            <% print.forEach(function (pr) { %>
            <button type="button" id ="rateButton" onclick="RateFunction()" class="btn btn-primary btn-lg" >Rate</button>
            <% }); %>

            <%}%>
            <br>
            <!-- Code changed -->
            <!-- Code changed -->

            <div class = "stars-outer">

              <div class = "stars-inner">


              </div>

            </div>

            <!-- Code changed -->
            <!-- Code changed -->

          </div>
          <br>
          <br>







        </div>
        <div class="container">
          <div class="row">
            <div class="col-md-12">

              <div class="tabbable-panel">
                <div class="tabbable-line">
                  <ul class="nav nav-tabs ">
                    <li class="active">
                      <a href="#tab_default_1" data-toggle="tab" style="padding-left: 5px; padding-right: 5px;">
                      Comments </a>
                    </li>
                    <li>
                      <a href="#tab_default_2" data-toggle="tab" style="padding-left: 5px; padding-right: 5px;">
                      Product Details </a>
                    </li>
                    <li>
                      <a href="#tab_default_3" data-toggle="tab" style="padding-left: 5px; padding-right: 5px;">
                      Product Overview </a>
                    </li>
                  </ul>
                  <div class="tab-content">
                    <div class="tab-pane " id="tab_default_3">
                      <p>

                      </p>
                      <p style="text-align:left">
                        <% print.forEach(function (pr) { %>
                        <%=pr.brand%><br>
                        <%=pr.name%><br>
                        <%=pr.model_no%><br>
                        <%=pr.description%>
                        <% }) %>
                      </p>


                    </div>
                    <div class="tab-pane" id="tab_default_2">

                      <p>
                        Will be updated.
                      </p>

                    </div>

                    <div class="tab-pane active " id="tab_default_1">
                      <br>
                      <div class="row">
                        <div class="col-lg-12">
                          <textarea class="form-control" name="FirstName" id="comment_info" rows="1" cols="50"  style="font-family:sans-serif;font-size:1.2em;"></textarea><br><br>

                          <input class="btn btn-primary" type="submit" id= "comment_submit" value="Submit"><br><br>
                        </div>
                      </div>
                      <script>
                        document.getElementById('comment_info').style.height="100px";
                        document.getElementById('comment_info').style.width="calc(100%)"
                      </script>


                      <div class="container-fluid">
                        <div class="row">
                          <div class="col-lg-12">

                          </div><!-- /col-sm-12 -->
                        </div><!-- /row -->

                        <% print.forEach(function (pr) { %>
                        <% print2.forEach(function (pr2) { %>
                        <%if (pr.model_no==pr2.product_id) { %>
                        <div class="row">
                          <div class="col-lg-1">
                            <div class="thumbnail">
                              <img class="img-responsive user-photo" src="https://ssl.gstatic.com/accounts/ui/avatar_2x.png">
                            </div><!-- /thumbnail -->
                          </div><!-- /col-sm-1 -->


                          <div class="row">
                            <div class="col-lg-5">
                              <div class="panel panel-default">
                                <div class="panel-heading">
                                  <div class="title">

                                    <strong><%=pr2.customer_id%></strong> <span class="date" ><%=pr2.comment_time%></span>

                                  </div>
                                  <p id="comment">

                                   <%=pr2.comment_info%>


                                 </p>
                               </div>

                             </div>
                           </div>
                         </div>


                       </div>
                       <% } %>
                       <% }) %>
                       <% }) %>
                     </div>
                   </div>
                 </div>

                 <br>
                 <br>
                 <center>
                  <strong>Powered by <a href="https://www.facebook.com/ahmet.sapan.9" target="_blank">wonderPC</a></strong>
                </center>
                <br>
                <br>

                <script src="/javascripts/navbar.js"></script>
              </body>




              </html>

              <script>

                $("[type='number']").keypress(function (evt) {
                  evt.preventDefault();
                });

                <% print.forEach(function (pr) { %>

                  var model = <%-JSON.stringify(pr.model_no)%>;

                  <% })%>


                var totalRating = 0;
                var counter = 0;
                <%print3.forEach(function(pr2){%>



                  totalRating += <%=pr2.ratingTotal%> ;
                  counter ++;


                  <%})%>
                var rating = totalRating / counter;

  //var rating = 4.0 ;
  
  const starsTotal = 5;
  var starPercentage = (rating/5) * 100;
  
  
  //alert(starPercentage);
  
  document.querySelector ('.stars-inner').style.width = starPercentage + '%';
  
  
  




  function RateFunction() {


    var ratingNumber = document.getElementById("ratingNumber").value;
    if (ratingNumber === ""){
      alert("Please choose a number between 1 and 5");
      return false;
    }
    $.ajax({
      type: 'POST',
      url: '/products/rating',
      data: JSON.stringify({proModel:model, rating1: ratingNumber }),
      contentType: "application/json; charset=utf-8",
      dataType: 'json'
    });





    location.reload();
  }

</script>


<script>
  var arr = {};
  $('#myAnchor').click(function(event) {
    var pid = document.getElementById('pid').value;
    var price = document.getElementById('price').value;
    var quantity = document.getElementById('quantity').value;

    alert("Product added to your cart");

    arr[0] = pid;
    arr[1] = price;
    arr[2] = quantity;

    $.ajax({
      type: 'POST',
      url: '/shopCart/shopCartForm',
      data: JSON.stringify(arr),
      contentType: "application/json; charset=utf-8",
      dataType: 'json'
    });

  });


</script>

<script>

  var arr2 = {};
  $('#comment_submit').click(function(event) {
    var comment_info = document.getElementById('comment_info').value;
    var pid2 = document.getElementById('pid2').value;
    arr2[0] = comment_info;
    arr2[1] = pid2;
    $.ajax({
      type: 'POST',
      url: '/products/comments',
      data: JSON.stringify(arr2),
      contentType: "application/json; charset=utf-8",
      dataType: 'json'
    });

    location.reload();
/*
    $.getJSON('/productManagerPage/deliveryDepartment', function(result) {
    $('#tablehere').html(" ");

      $("#tablehere").append( "<div>" + '<table id="t01">' + '<tr>' +

            '<th>' + 'DELIVERY ID' + '</th>' +
            '<th>' +'NAME'+ '</th>' +
            '<th>'+'SURNAME' +'</th>' +
            '<th>'+'EMAIL ADDRESS' +'</th>' +
            '<th>'+'MODEL NUMBER' +'</th>' +
            '<th>'+'AMOUNT' +'</th>' +
            '<th>'+'TOTAL PRICE' +'</th>' +
            '<th>'+'ADDRESS TO DELIVER' +'</th>' +
            '<th>'+'STATUS' +'</th>' + 
            '<th>'+'INVOICE' +'</th>' + '<tr>'
        );

        */
      });

    </script>



